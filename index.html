<html>
    <head>

        <title>Atrophy</title>
        <link rel="icon" type="image/x-icon" href="assets/lettuce.jpg">
        <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
        <!--<script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.0.0/dist/aframe-extras.min.js"></script>-->
        <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.2.0/dist/aframe-extras.min.js"></script>
        <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-physics-system@v4.2.2/dist/aframe-physics-system.min.js"></script>

        <script src="scripts/extended-wasd-controls.js"></script>

        <!-- Super hands -->
        <script src="https://unpkg.com/super-hands/dist/super-hands.min.js"></script>
        <script src="https://unpkg.com/aframe-event-set-component@^4.1.1/dist/aframe-event-set-component.min.js"></script>
        <script src="https://unpkg.com/aframe-physics-extras/dist/aframe-physics-extras.min.js"></script>

        <!-- Oculus thumbstick move controls-->
        <script src="https://gftruj.github.io/webzamples/aframe/controls/oculus-thumbstick-controls.js"></script>

        <script src="scripts/lamp-script.js"></script>
        <script src="scripts/fall-on-touch.js"></script>
        <script src="scripts/switch-1.js"></script>
        <script src="scripts/rain.js"></script>
        <script src="scripts/cloud.js"></script>
        <script src="scripts/staticCloud.js"></script>
        <script src="scripts/camera.js"></script>
        <script src="scripts/oculus-button-listeners.js"></script>
        <script src="scripts/phase-shift.js"></script>

        <script src="scripts/index.js"></script>

        <script src="https://kit.fontawesome.com/df8ef38841.js" crossorigin="anonymous"></script>
        <link rel="stylesheet" href="index.css">
    </head>
    <body>
        <a-scene add-lamps rain cloud static-cloud switch-1 
                physics="debug: false; friction: 0.1; restitution: 0.5;"
                background="color: black" 
                fog="type: exponential; 
                color: gray;
                density: 0.01;">

                    <!--<a-mixin id="all-interactions"
                                hoverable grabbable stretchable draggable
                                event-set__hoveron="_event: hover-start; material.opacity: 0.7; transparent: true"
                                event-set__hoveroff="_event: hover-end; material.opacity: 1; transparent: false"
                                dynamic-body
                    ></a-mixin>

                    <a-mixin id="grab-move"
                                hoverable grabbable draggable
                                event-set__hoveron="_event: hover-start; material.opacity: 0.7; transparent: true"
                                event-set__hoveroff="_event: hover-end; material.opacity: 1; transparent: false"
                                dynamic-body
                    ></a-mixin>

                    <a-mixin id="physics-hands"
                                physics-collider phase-shift
                                collision-filter="collisionForces: false"
                                static-body="shape: sphere; sphereRadius: 0.02"
                                super-hands="colliderEvent: collisions;
                                            colliderEventProperty: els;
                                            colliderEndEvent: collisions;
                                            colliderEndEventProperty: clearedEls;"
                    ></a-mixin>-->
            
            <!--Remove movement-controls from rig and extended-wasd-controls from camera entity to allow camera to fall-->
            <a-entity id="rig" movement-controls>
                <!-- Oculus Controls-->
                <a-entity id="rhand" mixin="physics-hands" super-hands 
                                oculus-touch-controls="hand: left" laser-controls="hand: left" raycaster="far: 100"
                                oculus-button-listeners oculus-thumbstick-controls>
                    <a-cursor material="color: white; opacity: 0; shader: flat"></a-cursor>
                </a-entity>
                <a-entity id="lhand" mixin="physics-hands" super-hands 
                            oculus-touch-controls="hand: right" laser-controls="hand: right" raycaster="far: 200"
                            oculus-button-listeners oculus-thumbstick-controls>
                    <a-cursor material="color: white; opacity: 0; shader: flat"></a-cursor>
                </a-entity>
                
                <a-entity extended-wasd-controls="flyEnabled: false; turnEnabled: true; lookEnabled: true; maxLookAngle: 360;"
                        id="camera-entity" camera-listener position="0 0 0" rotation="0 0 0">
                    <a-camera
                        look-controls="pointerLockEnabled: true;"
                        static-body="mass: 1"
                        position="0 1 0"
                        rotation="0 180 0"
                        wasd-controls="acceleration: 100">
                        <a-cursor id="camera-cursor" material="color: black; opacity: 0.5; shader: flat"></a-cursor>
                    </a-camera>
                </a-entity>
            </a-entity>

            <!--<a-box mixin="cube all-interactions" position="0 0 -15" scale="8 30 8" color="red" ></a-box>-->

            <a-sky radius="900" color="black"></a-sky>

            <!--objects-->
            <!--<a-torus-knot fall-on-touch
                arc="180" p="2" q="7" radius="5" radius-tubular="1" position="0 0 10"
                shadow="cast: true; receive: true;" 
                material="color: cyan; transparent: true; opacity: 1"
                animation="property: rotation; to: 0 0 360; loop: true; easing: linear; dur: 25000"></a-torus-knot>
            
            <a-torus-knot fall-on-touch
                            arc="180" p="2" q="7" radius="5" radius-tubular=".1" 
                            src="#gradient1"
                            position="1 4 -2" rotation="0 0 0" color= "#ffffff"
                            shadow="cast: true; receive: true;"
                            material="transparent: true; opacity: 1"
                            animation="property: rotation; to: 0 0 360; loop: true; easing: linear; dur: 25000"></a-torus-knot>-->
            
            <!--lights-->
            <a-light id="blue-ambience" type="ambient" intensity="0" color="#0009ff"></a-light>
            <a-light color="#FFFFFF" intensity="0" position="20 10 20"></a-light>
            
            <a-plane static-body color="gray" rotation="-90 0 0" scale="800 800 1" position="0 -15 0" shadow="receive: true"></a-plane>
        </a-scene>
        <div class="menu" id="menu">
            <div class="controls-container">
                <div class="controls-text">Look</div>
                <img src="assets/mouse.svg" alt="WASD" width="40px"/>
            </div>
            <div class="controls-container">
                <div class="controls-text">Move</div>
                <div>
                    <img src="assets/wasd.svg" alt="WASD" width="200px" style="margin-right: 10px;"/>
                    <img src="assets/arrows.svg" alt="WASD" width="200px" style="margin-left: 10px;"/>
                </div>
            </div>
            <div class="controls-container">
                <div class="controls-text">Warp</div>
                <img src="assets/space.svg" alt="WASD" width="230px"/>
            </div>
        </div>
        <div class="menu-btn" id="menu-btn">
            <div class="menu-btn-border">
                <i class="fa-solid fa-gamepad"></i>
            </div>
        </div>
    </body>
</html>